<!-- Sortierbare Playlist -->
<div [sortablejs]="files"
     (update)=sortDone($event)>

    <!-- Ueber Files gehen und Ausschnitt der Liste anzeigen, nur Titel im oberen Bereich sind sortierbar -->
    <div *ngFor="let file of files | slice:0:20; index as index, last as last, first as first"
         class="bg-white"
         [ngClass]="{
                 'drag': draggable(index),
                 'pt-2': !first && index !== insertIndex,
                 'pb-2': last
                }">

        <!-- Einfuegemarke, wo der naechste neue Titel eingefuegt wird -->
        <div class="ml-3 d-flex align-items-center color-controls insertIndex"
             *ngIf="index === insertIndex">
            <fa-icon icon="share"
                     fixedWidth="true"
                     class="px-1 color-controls"></fa-icon>

            <!-- Vorschau, welcher Titel hier eingefuegt wird -->
            <div class="ml-2 opacity-80">{{hoverTitle | fileName}}</div>
        </div>

        <!-- Einfuegemarke und Songtitel -->
        <div class="ml-3 mr-3 d-flex no-gutters align-items-center">

            <!-- Song abspielen Button, aber nicht wenn Titel gearde geladen wird -->
            <button *ngIf="index !== jumpPosition"
                    class="btn btn-sm order-1 px-1"
                    (click)="jumpTo(index)">
                <fa-icon icon="play"
                         fixedWidth="true"
                         [hover-class]="'opacity-100'"
                         [ngClass]="{
                       'opacity-50': index !== 0,
                       'color-controls': index === 0}"></fa-icon>
            </button>

            <!-- Spinner anzeigen, wenn zu diesem Titel gesprungen werden soll -->
            <div *ngIf="index === jumpPosition"
                 class="spinner-block">
                <fa-icon icon="spinner"
                         spin="true"
                         fixedWidth="true"
                         class="color-controls"></fa-icon>
            </div>

            <!-- Titel ignroerien (=nach ganz hinten schieben), aber nicht bei Index 0 -->
            <!-- CSS Trick mit flex-order, damit durchstreichen per CSS funktioniert und Button trotzdem hinten steht -->
            <button *ngIf="index !== 0"
                    class="btn btn-sm opacity-50 order-3 ignore"
                    [hover-class]="'opacity-100'"
                    (click)="moveTitleToEnd(index)">
                <fa-icon icon="minus"
                         fixedWidth="true"></fa-icon>
            </button>

            <!-- Titelinfo, aktuellen Song fett darstellen, im oberen Bereich ist Liste sortierbar -->
            <div class="ml-2 order-2 col"
                 [ngClass]="{
                        'font-weight-bold': index === 0,
                        'sort-handle': draggable(index),
                        'cursor-pointer': index >= insertIndex}"
                 (mouseenter)="setHoverTitle(index)"
                 (mouseleave)="resetHoverTitle()"
                 (click)="enqueueSong(index)">

                <!-- Titelname -->
                <span>{{file | fileName}}</span>
            </div>
        </div>
    </div>
</div>